## 7.29-8.25 科研周记

### 第一周（7.29-8.4）

1. 弄懂了 logistic 回归中正态分布模拟U型关系的原理。具体原理是，当某处的病例组数量明显高于对照组时，此处的 logit(π) 就会比较高，当病例组与对照组的模拟正态分布的均值相同，病例组的方差大于对照组时，病例组与对照组在中间位置的数量接近，logit(π) 较小，病例组的分布更离散，两侧的数量更多，因此两侧的 logit(π) 较大，此时就形成了自变量与 logi(π) 的 U 型关系。

2. 实现 cox 回归中多个 U 型自变量时间 T 的模拟，具体实现公式是：
   $$
   T_0=\left(-\frac{\log(U)}{\lambda \exp(s(x_1)+s(x_2))}\right)^{1/\nu}
   $$
   其原理就是将 cox 模型中的 $\beta x$ 改为用样条函数拟合的 $s(x)$ 即可，多个 U 型自变量就是多个 $s(x)$。

3. 读完了陈逸敏的毕业论文，产生了以下疑问：

   * 为何将自变量离散化后构建的 cox 模型的结果中，由一个变量变成了多个变量？

     已解决，并不是由一个变量变成了多个变量，而是变为离散变量后，结果会进行哑变量编码，看起来似乎有多个变量，并且此时会有一个对照变量，这个变量是对照组，不会出现在结果中，它的风险函数为 $h_0(t)$（该变量取值为 0 ）。

4. 找到了一个平滑的模拟 U 型曲线的函数，其中 $a_1$ 和 $a_2$ 用来控制两侧的“斜率”，$h$ 用来控制中心点的位置，具体公式如下：
   $$
   s(x)=\left\{\begin{matrix} 
     a_1(x-h)^2 ,x\leqslant h \\  
     a_2(x-h)^2 ,x>h
   \end{matrix}\right.
   $$
   

### 第二周（8.5-8.11）

1. 利用 R 语言实现了上周找到的平滑的模拟 U 型曲线的函数。
2. 利用 `smoothHR` 包构建了 cox 模型。`pspline` 函数能够估计单个协变量的平滑效果，并通过交叉验证等方法来选择最优的自由度。`smoothHR` 包提供的 `dfmacox` 函数则可以选择出多个非线性协变量的最优自由度。
3. 用 $\mu \pm 2\sigma$ 排除了生成的自变量的异常值，排除异常值后 U 型关系非常明显。

### 第三周（8.12-8.18）

1. 实现了生成不同场景下1000个模拟数据

### 第四周（8.19-8.25）

无（开学考试复习）
